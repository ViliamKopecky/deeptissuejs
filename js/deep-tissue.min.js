/*
Copyright (c) 2013 Chris Love

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/

;(function(e,t){"use strict";var n=function(e,t){return new n.fn.init(e,t)};return n.fn=n.prototype={constructor:n,init:function(t,n){var r=this;return t?("length"in t?this.node=t:this.node=[t],this.settings=this.extend({},this.settings,n),this.buildVendorNames(),this.touchType=e.navigator.msPointerEnabled?"pointer":"ontouchstart"in e?"touch":"mouse",this.hasMouse="ontouchstart"in e&&"onmousedown"in e,this.touchStart=this.touchType==="pointer"?"MSPointerDown":this.touchType==="touch"?"touchstart":"mousedown",this.touchEnd=this.touchType==="pointer"?"MSPointerUp":this.touchType==="touch"?"touchend":"mouseup",this.touchOut=this.touchType==="pointer"?"MSPointerOut":this.touchType==="touch"?"touchcancel":"mouseout",this.touchMove=this.touchType==="pointer"?"MSPointerMove":this.touchType==="touch"?"touchmove":"mousemove",this.touchCancel=this.touchType==="pointer"?"MSPointerCancel":this.touchType==="touch"?"touchcancel":"mouseout",this.hasmsGesture?this.setupMSGesture():(this.setUpTouchGestures(),this.setupTouch()),this):t},version:"0.0.3",hasMouse:"",touchType:"",touchStart:"",touchEnd:"",touchOut:"",touchMove:"",touchCancel:"",hasmsGesture:e.MSGesture,setUpTouchGestures:function(){var e=this;try{[].forEach.call(this.node,function(t){t.addEventListener("gesturestart",function(e){e.preventDefault()}),t.addEventListener("gesturechange",function(t){e.gestureChange.call(e,t)}),t.gStartScale=1,t.gStartRotation=0})}catch(t){var n=document.querySelector(".touch-log");return n.innerText="setUpTouchGestures is broken \r\n"+n.innerText,!1}},setupMSGesture:function(){var e=this,t=this.settings;try{[].forEach.call(this.node,function(n){var r=new MSGesture;r&&(r.target=n,n.addEventListener("MSPointerDown",function(i){r.addPointer(i.pointerId),e.setupSwipe(i,n,t)}),n.addEventListener("MSGestureChange",function(t){e.msGestureChange.call(e,t)}),n.addEventListener("MSPointerDown",function(r){e.doDoubleTap(r,n,t)}))})}catch(n){return!1}},swipeRightCallback:function(){},swipeLeftCallback:function(){},swipeUpCallback:function(){},swipeDownCallback:function(){},moveCallback:function(){},moveHorizontalCallback:function(){},moveVerticalCallback:function(){},rotateCallback:function(){},scaleCallback:function(){},tapCallback:function(){},doubleTapCallback:function(){},tapHoldCallback:function(){},processGestureChange:function(e,t){var n=this,r=this.settings,i=e.target;i.hasAttribute(r.rotateIndicator)&&Math.abs(e.rotation)>r.rotateThreshold&&(i.style.transform=t.rotate(e.rotation*180/Math.PI),this.rotateCallback(e,t)),i.hasAttribute(r.scaleIndicator)&&Math.abs(e.scale)>r.scaleThreshold&&(i.style.transform=t.scale(e.scale),this.scaleCallback(e,t)),i.hasAttribute(r.moveIndicator)&&(Math.abs(e.translationX)>r.moveThreshold||Math.abs(e.translationY)>r.moveThreshold)&&(i.style.transform=t.translate(e.translationX,e.translationY,0),this.moveCallback(e,t)),i.hasAttribute(r.horizontalIndicator)&&Math.abs(e.translationX)>r.moveThreshold&&(e.target.style.transform=t.translate(e.translationX,0,0),this.moveHorizontalCallback(e,t)),i.hasAttribute(r.verticalIndicator)&&Math.abs(e.translationY)>r.moveThreshold&&(e.target.style.transform=t.translate(0,e.translationY,0),this.moveVerticalCallback(e,t)),i.hasAttribute(r.swipeRight)&&e.translationX>0&&e.translationX>r.swipeRightThreshold&&(console.log("should swipe right"),n.swipeRightCallback(e,t)),i.hasAttribute(r.swipeLeft)&&e.translationX<0&&Math.abs(e.translationX)>r.swipeLeftThreshold&&(console.log("should swipe left"),n.swipeLeftCallback(e,t)),i.hasAttribute(r.swipeUp)&&e.translationY<0&&Math.abs(e.translationY)>r.swipeUpThreshold&&n.swipeUpCallback(e,t),i.hasAttribute(r.swipeDown)&&e.translationY>0&&e.translationY>r.swipeDownThreshold&&n.swipeDownCallback(e,t),console.log(e.translationX+" - "+e.translationY)},gestureChange:function(e){var t=e.target,n=this.settings;e.preventDefault();var r=document.querySelector(".touch-log");r.innerText="gesture Change \r\n"+t.hasAttribute(n.rotateIndicator)+"\r\n"+r.innerText,t.hasAttribute(n.rotateIndicator)&&Math.abs(e.rotation)>n.rotateThreshold&&(t.style.webkitTransform="rotate("+(t.gStartRotation+e.rotation)+"deg)",this.rotateCallback(e,m)),t.hasAttribute(n.scaleIndicator)&&Math.abs(e.scale)>n.scaleThreshold&&(t.style.webkitTransform="scale("+t.gStartScale*e.scale+") ",this.scaleCallback(e,m))},msGestureChange:function(t){e.MSCSSMatrix&&this.processGestureChange(t,new MSCSSMatrix(t.target.style.transform))},calculateTranslation:function(e,t){return{translationX:t.x-e.x,translationY:t.y-e.y}},setupIndicator:function(e,n,r,i,s){var o=this,u=this.settings;e!==t&&(this[n]=e),r&&(this.settings[i]=r),[].forEach.call(this.node,function(e){e.setAttribute(u[s],"true")})},PreventDefaultManipulationAndMouseEvent:function(e){if(e.preventDefault){e.preventDefault();return}if(e.preventManipulation){e.preventManipulation();return}if(e.preventMouseEvent){e.preventMouseEvent();return}},getTouchPoints:function(e){var t=this,n=typeof e.changedTouches!="undefined"?e.changedTouches:[e],r=n[n.length-1],i;return t.touchType==="pointer"?i={x:r.x,y:r.y}:t.touchType==="touch"?i={x:r.pageX,y:r.pageY}:i={x:e.pageX,y:e.pageY},i},node:t,extend:function(){var e=arguments[0]||{},n=1,r,i,s,o,u=arguments.length;for(;n<u;n++)if((o=arguments[n])!==null)for(name in o){r=e[i],s=o[i];if(e===s)continue;s!==t&&(e[i]=s)}return e},div:t,support:{},buildVendorNames:function(){this.div=document.createElement("div"),this.support.transition=this.getVendorPropertyName("transition"),this.support.transitionDelay=this.getVendorPropertyName("transitionDelay"),this.support.transform=this.getVendorPropertyName("transform"),this.support.transformOrigin=this.getVendorPropertyName("transformOrigin"),this.support.transform3d=this.checkTransform3dSupport(),this.div=null},getVendorPropertyName:function(e){var t=["Moz","Webkit","O","ms"],n,r,i=e.charAt(0).toUpperCase()+e.substr(1);if(e in this.div.style)return e;for(r=0;r<t.length;++r){n=t[r]+i;if(n in this.div.style)return n}},checkTransform3dSupport:function(){return this.div.style[this.support.transform]="",this.div.style[this.support.transform]="rotateY(90deg)",this.div.style[this.support.transform]!==""},doDoubleTap:function(e,t,n){var r=this;t.hasAttribute(n.doubleTapIndicator)&&t.hasAttribute(n.doubleTapStart)&&(t.removeAttribute(n.doubleTapStart),clearTimeout(t.getAttribute(n.doubleTapStart)),r.doubleTapCallback(e)),t.hasAttribute(n.doubleTapIndicator)&&!t.hasAttribute(n.doubleTapStart)&&t.setAttribute(n.doubleTapStart,setTimeout(function(){t.removeAttribute(n.doubleTapStart),clearTimeout(t.getAttribute(n.doubleTapStart))},n.doubleTapThreshold))},setupSwipe:function(e,t,n){var r=this;t.hasAttribute(n.swipeRight)&&(t.removeAttribute(n.swipeRightEnd),t.hasAttribute(n.swipeRightInit)||t.setAttribute(n.swipeRightInit,JSON.stringify(r.getTouchPoints(e)))),t.hasAttribute(n.swipeLeft)&&(t.removeAttribute(n.swipeLeftEnd),t.hasAttribute(n.swipeLeftInit)||t.setAttribute(n.swipeLeftInit,JSON.stringify(r.getTouchPoints(e)))),t.hasAttribute(n.swipeUp)&&(t.removeAttribute(n.swipeUpEnd),t.hasAttribute(n.swipeUpInit)||t.setAttribute(n.swipeUpInit,JSON.stringify(r.getTouchPoints(e)))),t.hasAttribute(n.swipeDown)&&(t.removeAttribute(n.swipeDownEnd),t.hasAttribute(n.swipeDownInit)||t.setAttribute(n.swipeDownInit,JSON.stringify(r.getTouchPoints(e))))},setupTouch:function(){var e=this,t=this.settings;[].forEach.call(this.node,function(n){var r=function(r){r.preventDefault(),e.touchMoveHandler.call(e,r,n,t)},i=function(r){r.preventDefault(),e.endTouchHandler.call(e,r,n,t)},s=function(r){r.preventDefault(),e.startTouchHandler.call(e,r,n,t)};n.addEventListener(e.touchStart,s),n.addEventListener(e.touchMove,r),n.addEventListener(e.touchEnd,i),e.hasMouse&&(n.addEventListener("mousedown",s),n.addEventListener("mousemove",r),n.addEventListener("mouseup",i))})},startTouchHandler:function(e,t,n){var r=this;n=this.settings,e.preventDefault(),console.log("touch start"),t.hasAttribute(n.moveIndicator)&&(t.removeAttribute(n.moveTouchEnded),t.hasAttribute(n.moveTouchInitial)||t.setAttribute(n.moveTouchInitial,JSON.stringify(r.getTouchPoints(e)))),t.hasAttribute(n.horizontalIndicator)&&(t.removeAttribute(n.horizontalTouchEnd),t.hasAttribute(n.horizontalTouchInit)||t.setAttribute(n.horizontalTouchInit,JSON.stringify(r.getTouchPoints(e)))),t.hasAttribute(n.verticalIndicator)&&(t.removeAttribute(n.verticalTouchEnd),t.hasAttribute(n.verticalTouchInit)||t.setAttribute(n.verticalTouchInit,JSON.stringify(r.getTouchPoints(e)))),r.setupSwipe(e,t,n),t.hasAttribute(n.tapIndicator)&&!t.hasAttribute(n.tapStart)&&t.setAttribute(n.tapStart,setTimeout(function(){clearTimeout(t.getAttribute(n.tapStart)),t.removeAttribute(n.doubleTapStart)},700)),r.doDoubleTap(e,t,n)},endTouchHandler:function(e,t,n){var r=this;n=this.settings,e.preventDefault(),t.hasAttribute(n.moveTouchInitial)&&t.setAttribute(n.moveTouchEnded,"true"),t.hasAttribute(n.horizontalIndicator)&&t.setAttribute(n.horizontalTouchEnd,"true"),t.hasAttribute(n.verticalIndicator)&&t.setAttribute(n.verticalTouchEnd,"true"),t.hasAttribute(n.swipeRight)&&t.setAttribute(n.swipeRightEnd,"true"),t.hasAttribute(n.swipeLeft)&&t.setAttribute(n.swipeLeftEnd,"true"),t.hasAttribute(n.swipeUp)&&t.setAttribute(n.swipeUpEnd,"true"),t.hasAttribute(n.swipeDown)&&t.setAttribute(n.swipeDownEnd,"true"),t.hasAttribute(n.tapIndicator)&&t.hasAttribute(n.tapStart)&&(r.tapCallback(e),clearTimeout(t.getAttribute(n.tapStart)),t.removeAttribute(n.tapStart))},touchMoveHandler:function(e,t,n){var r=this;n=this.settings,e.preventDefault(),t.hasAttribute(n.moveIndicator)&&!t.hasAttribute(n.moveTouchEnded)&&t.hasAttribute(n.moveTouchInitial)&&(i=JSON.parse(t.getAttribute(n.moveTouchInitial)),s=r.getTouchPoints(e),o=r.calculateTranslation(i,s),t.style[r.support.transform]="translate3D("+o.translationX+"px, "+o.translationY+"px, 0)");if(t.hasAttribute(n.horizontalIndicator)&&!t.hasAttribute(n.horizontalTouchEnd)&&t.hasAttribute(n.horizontalTouchInit)){console.log("should -horizontal move");var i=JSON.parse(t.getAttribute(n.horizontalTouchInit)),s=r.getTouchPoints(e),o=r.calculateTranslation(i,s);Math.abs(o.translationX)>r.settings.moveThreshold&&(t.style[r.support.transform]="translate3D("+o.translationX+"px, 0, 0)")}if(t.hasAttribute(n.verticalIndicator)&&!t.hasAttribute(n.verticalTouchEnd)&&t.hasAttribute(n.verticalTouchInit)){var i=JSON.parse(t.getAttribute(n.verticalTouchInit)),s=r.getTouchPoints(e),o=r.calculateTranslation(i,s);Math.abs(o.translationY)>r.settings.moveThreshold&&(t.style[r.support.transform]="translate3D(0, "+o.translationY+"px, 0)")}if(t.hasAttribute(n.swipeRight)&&!t.hasAttribute(n.swipeRightEnd)&&t.hasAttribute(n.swipeRightInit)){console.log("should swipe right");var i=JSON.parse(t.getAttribute(n.swipeRightInit)),s=r.getTouchPoints(e),o=r.calculateTranslation(i,s);o.translationX>0&&Math.abs(o.translationX)>n.swipeRightThreshold&&(r.swipeRightCallback(e,null,o),t.setAttribute(n.swipeLeftInit,JSON.stringify(r.getTouchPoints(e))),t.setAttribute(n.swipeRightInit,JSON.stringify(r.getTouchPoints(e))))}if(t.hasAttribute(n.swipeLeft)&&!t.hasAttribute(n.swipeLeftEnd)&&t.hasAttribute(n.swipeLeftInit)){console.log("should swipe left");var i=JSON.parse(t.getAttribute(n.swipeLeftInit)),s=r.getTouchPoints(e),o=r.calculateTranslation(i,s);o.translationX<0&&Math.abs(o.translationX)>n.swipeLeftThreshold&&(r.swipeLeftCallback(e,null,o),t.setAttribute(n.swipeLeftInit,JSON.stringify(r.getTouchPoints(e))),t.setAttribute(n.swipeRightInit,JSON.stringify(r.getTouchPoints(e))))}if(t.hasAttribute(n.swipeUp)&&!t.hasAttribute(n.swipeUpEnd)&&t.hasAttribute(n.swipeUpInit)){console.log("should swipe up");var i=JSON.parse(t.getAttribute(n.swipeUpInit)),s=r.getTouchPoints(e),o=r.calculateTranslation(i,s);o.translationY<0&&Math.abs(o.translationY)>n.swipeUpThreshold&&(r.swipeUpCallback(e,null,o),t.setAttribute(n.swipeUpInit,JSON.stringify(r.getTouchPoints(e))),t.setAttribute(n.swipeDownInit,JSON.stringify(r.getTouchPoints(e))))}if(t.hasAttribute(n.swipeDown)&&!t.hasAttribute(n.swipeDownEnd)&&t.hasAttribute(n.swipeDownInit)){console.log("should swipe down");var i=JSON.parse(t.getAttribute(n.swipeDownInit)),s=r.getTouchPoints(e),o=r.calculateTranslation(i,s);o.translationY>0&&o.translationY>n.swipeDownThreshold&&(r.swipeDownCallback(e,null,o),t.setAttribute(n.swipeUpInit,JSON.stringify(r.getTouchPoints(e))),t.setAttribute(n.swipeDownInit,JSON.stringify(r.getTouchPoints(e))))}},settings:{allowPageScroll:!0,logging:!1,swipeRightThreshold:25,swipeLeftThreshold:-25,swipeUpThreshold:25,swipeDownThreshold:25,moveThreshold:0,rotateThreshold:0,scaleThreshold:0,doubleTapThreshold:700,tapIndicator:"data-tap",tapStart:"data-tap-start",tapEnded:"data-tap-end",doubleTapIndicator:"data-dbltap",doubleTapStart:"data-dbltap-start",doubleTapEnded:"data-dbltap-end",rotateIndicator:"data-rotate",rotateEnded:"data-rotate-ended",rotateInitial:"data-rotate-initial",scaleIndicator:"data-scale",scaleEnded:"data-scale-ended",scaleInitial:"data-scale-initial",moveIndicator:"data-move",moveTouchEnded:"data-move-touch-ended",moveTouchInitial:"data-move-touch-initial",swipeRight:"data-swiperight",swipeRightInit:"data-swiperight-init",swipeRightEnd:"data-swiperight-end",swipeLeft:"data-swipeleft",swipeLeftInit:"data-swipeLeft-init",swipeLeftEnd:"data-swipeleft-end",swipeUp:"data-swipeup",swipeUpInit:"data-swipeup-init",swipeUpEnd:"data-swipeup-end",swipeDown:"data-swipedown",swipeDownInit:"data-swipedown-init",swipeDownEnd:"data-swipedown-end",horizontalIndicator:"data-move-horizontal",horizontalTouchInit:"data-horizontal-touch-initial",horizontalTouchEnd:"data-horizontal-touch-ended",verticalIndicator:"data-move-vertical",verticalTouchInit:"data-vertical-touch-initial",verticalTouchEnd:"data-vertical-touch-ended"}},n.fn.init.prototype=n.fn,e.deeptissue=n})(window),function(e,t,n){"use strict";t.fn.move=function(e){return this.setupIndicator(e,"moveCallback",0,"","moveIndicator"),this},t.fn.horizontalMove=function(e){return this.setupIndicator(e,"moveHorizontalCallback",0,"","horizontalIndicator"),this},t.fn.verticalMove=function(e){return this.setupIndicator(e,"moveVerticalCallback",0,"","verticalIndicator"),this}}(window,deeptissue),function(e,t,n){"use strict";t.fn.tap=function(e){var t=this;return e||(e=function(){}),t.hasmsGesture?[].forEach.call(this.node,function(t){t.addEventListener("MSGestureTap",e,!1)}):this.setupIndicator(e,"tapCallback",0,"","tapIndicator"),this},t.fn.dblTap=function(e){var t=this,n=this.settings,r=document.querySelector(".touch-log");return e&&(n.doubleTapCallback=e),this.setupIndicator(e,"doubleTapCallback",0,"","doubleTapIndicator"),this},t.fn.tapHold=function(e,t,n){var r=this;return e&&(r.tapHoldBeginCallback=e),this.hasmsGesture?[].forEach.call(this.node,function(e){e.addEventListener("MSGestureHold",function(e){r.tapHoldCallback.call(r,e)},!1)}):[].forEach.call(this.node,function(e){e.addEventListener(r.touchStart,function(t){r.setupTapHold(e,t)}),r.hasMouse&&e.addEventListener("mousedown",function(t){r.setupTapHold(e,t)})},!1),this},t.fn.setupTapHold=function(e,t){var n=this,r;r=setTimeout(function(){n.tapHoldBeginCallback.call(n,t),clearTimeout(r)},500),e.addEventListener(n.touchEnd,function(e){clearTimeout(r)},!1),e.addEventListener(n.touchCancel,function(e){clearTimeout(r)},!1)},t.fn.tapHoldBeginCallback=function(){},t.fn.tapHoldEndCallback=function(){},t.fn.tapHoldCancelCallback=function(){},t.fn.tapHoldCallback=function(e){console.info("evt.detail - "+e.detail),e.detail&e.MSGESTURE_FLAG_BEGIN&&this.tapHoldBeginCallback.call(this,e),e.detail&e.MSGESTURE_FLAG_END&&this.tapHoldEndCallback.call(this,e),e.detail&e.MSGESTURE_FLAG_CANCEL&&this.tapHoldCancelCallback.call(this,e)}}(window,deeptissue),function(e,t,n){"use strict";t.fn.rotate=function(e){return this.setupIndicator(e,"rotateCallback",0,"","rotateIndicator"),this}}(window,deeptissue),function(e,t,n){"use strict";t.fn.scale=function(e){return this.setupIndicator(e,"scaleCallback",0,"","scaleIndicator"),this}}(window,deeptissue),function(e,t,n){"use strict";t.fn.swipeRight=function(e,t){return this.setupIndicator(e,"swipeRightCallback",t,"swipeRightThreshold","swipeRight"),this},t.fn.swipeLeft=function(e,t){return this.setupIndicator(e,"swipeLeftCallback",t,"swipeLeftThreshold","swipeLeft"),this},t.fn.swipeUp=function(e,t){return this.setupIndicator(e,"swipeUpCallback",t,"swipeUpThreshold","swipeUp"),this},t.fn.swipeDown=function(e,t){return this.setupIndicator(e,"swipeDownCallback",t,"swipeDownThreshold","swipeDown"),this}}(window,deeptissue);