/*
Copyright (c) 2013 Chris Love

http://deeptissuejs.com
https://github.com/docluv/deeptissuejs

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/


(function(t,e){"use strict";var i=function(t,e){return new i.fn.init(t,e)};return i.fn=i.prototype={constructor:i,init:function(e,i){return e?(this.node="length"in e?e:[e],this.settings=this.extend({},this.settings,i),this.buildVendorNames(),this.touchType=t.navigator.msPointerEnabled?"pointer":"ontouchstart"in t?"touch":"mouse",this.hasMouse="ontouchstart"in t&&"onmousedown"in t,this.touchStart="pointer"===this.touchType?"MSPointerDown":"touch"===this.touchType?"touchstart":"mousedown",this.touchEnd="pointer"===this.touchType?"MSPointerUp":"touch"===this.touchType?"touchend":"mouseup",this.touchOut="pointer"===this.touchType?"MSPointerOut":"touch"===this.touchType?"touchcancel":"mouseout",this.touchMove="pointer"===this.touchType?"MSPointerMove":"touch"===this.touchType?"touchmove":"mousemove",this.touchCancel="pointer"===this.touchType?"MSPointerCancel":"touch"===this.touchType?"touchcancel":"mouseout",this.hasmsGesture?this.setupMSGesture():(this.setUpTouchGestures(),this.setupTouch()),this):e},version:"0.0.4",hasMouse:"",touchType:"",touchStart:"",touchEnd:"",touchOut:"",touchMove:"",touchCancel:"",hasmsGesture:t.MSGesture,setUpTouchGestures:function(){var t=this;try{[].forEach.call(this.node,function(e){e.addEventListener("gesturestart",function(t){t.preventDefault()}),e.addEventListener("gesturechange",function(e){t.gestureChange.call(t,e)}),e.gStartScale=1,e.gStartRotation=0})}catch(e){var i=document.querySelector(".touch-log");return i.innerText="setUpTouchGestures is broken \r\n"+i.innerText,!1}},setupMSGesture:function(){var t=this,e=this.settings;try{[].forEach.call(this.node,function(i){var a=new MSGesture;a&&(a.target=i,i.addEventListener("MSPointerDown",function(n){a.addPointer(n.pointerId),t.setupSwipe(n,i,e)}),i.addEventListener("MSGestureChange",function(e){t.msGestureChange.call(t,e)}),i.addEventListener("MSPointerDown",function(a){t.doDoubleTap(a,i,e)}))})}catch(i){return!1}},swipeRightCallback:function(){},swipeLeftCallback:function(){},swipeUpCallback:function(){},swipeDownCallback:function(){},moveCallback:function(){},moveHorizontalCallback:function(){},moveVerticalCallback:function(){},rotateCallback:function(){},scaleCallback:function(){},tapCallback:function(){},doubleTapCallback:function(){},tapHoldCallback:function(){},processGestureChange:function(t,e){var i=this,a=this.settings,n=t.target;n.hasAttribute(a.rotateIndicator)&&Math.abs(t.rotation)>a.rotateThreshold&&(n.style.transform=e.rotate(180*t.rotation/Math.PI),this.rotateCallback(t,e)),n.hasAttribute(a.scaleIndicator)&&Math.abs(t.scale)>a.scaleThreshold&&(n.style.transform=e.scale(t.scale),this.scaleCallback(t,e)),n.hasAttribute(a.moveIndicator)&&(Math.abs(t.translationX)>a.moveThreshold||Math.abs(t.translationY)>a.moveThreshold)&&(n.style.transform=e.translate(t.translationX,t.translationY,0),this.moveCallback(t,e)),n.hasAttribute(a.horizontalIndicator)&&Math.abs(t.translationX)>a.moveThreshold&&(t.target.style.transform=e.translate(t.translationX,0,0),this.moveHorizontalCallback(t,e)),n.hasAttribute(a.verticalIndicator)&&Math.abs(t.translationY)>a.moveThreshold&&(t.target.style.transform=e.translate(0,t.translationY,0),this.moveVerticalCallback(t,e)),n.hasAttribute(a.swipeRight)&&t.translationX>0&&t.translationX>a.swipeRightThreshold&&(console.log("should swipe right"),i.swipeRightCallback(t,e)),n.hasAttribute(a.swipeLeft)&&0>t.translationX&&Math.abs(t.translationX)>a.swipeLeftThreshold&&(console.log("should swipe left"),i.swipeLeftCallback(t,e)),n.hasAttribute(a.swipeUp)&&0>t.translationY&&Math.abs(t.translationY)>a.swipeUpThreshold&&i.swipeUpCallback(t,e),n.hasAttribute(a.swipeDown)&&t.translationY>0&&t.translationY>a.swipeDownThreshold&&i.swipeDownCallback(t,e),console.log(t.translationX+" - "+t.translationY)},gestureChange:function(t){var e=t.target,i=this.settings;t.preventDefault();var a=document.querySelector(".touch-log");a.innerText="gesture Change \r\n"+e.hasAttribute(i.rotateIndicator)+"\r\n"+a.innerText,e.hasAttribute(i.rotateIndicator)&&Math.abs(t.rotation)>i.rotateThreshold&&(e.style.webkitTransform="rotate("+(e.gStartRotation+t.rotation)+"deg)",this.rotateCallback(t,m)),e.hasAttribute(i.scaleIndicator)&&Math.abs(t.scale)>i.scaleThreshold&&(e.style.webkitTransform="scale("+e.gStartScale*t.scale+") ",this.scaleCallback(t,m))},msGestureChange:function(e){t.MSCSSMatrix&&this.processGestureChange(e,new MSCSSMatrix(e.target.style.transform))},calculateTranslation:function(t,e){return{translationX:e.x-t.x,translationY:e.y-t.y}},setupIndicator:function(t,i,a,n,o){var s=this,r=s.settings;t!==e&&(s[i]=t),a&&(s.settings[n]=a),[].forEach.call(s.node,function(t){t.setAttribute(r[o],"true")})},PreventDefaultManipulationAndMouseEvent:function(t){return t.preventDefault?(t.preventDefault(),e):t.preventManipulation?(t.preventManipulation(),e):t.preventMouseEvent?(t.preventMouseEvent(),e):e},getTouchPoints:function(t){var i,a=this,n=t.changedTouches!==e?t.changedTouches:[t],o=n[n.length-1];return i="pointer"===a.touchType?{x:o.x,y:o.y}:"touch"===a.touchType?{x:o.pageX,y:o.pageY}:{x:t.pageX,y:t.pageY}},node:e,extend:function(){var t,i,a,n,o=arguments[0]||{},s=1,r=arguments.length;for(s=1;r>s;s++)if(null!==(n=arguments[s]))for(name in n)t=o[i],a=n[i],o!==a&&a!==e&&(o[i]=a);return o},div:e,support:{},buildVendorNames:function(){this.div=document.createElement("div"),this.support.transition=this.getVendorPropertyName("transition"),this.support.transitionDelay=this.getVendorPropertyName("transitionDelay"),this.support.transform=this.getVendorPropertyName("transform"),this.support.transformOrigin=this.getVendorPropertyName("transformOrigin"),this.support.transform3d=this.checkTransform3dSupport(),this.div=null},getVendorPropertyName:function(t){var e,i,a=["Moz","Webkit","O","ms"],n=t.charAt(0).toUpperCase()+t.substr(1);if(t in this.div.style)return t;for(i=0;a.length>i;++i)if(e=a[i]+n,e in this.div.style)return e},checkTransform3dSupport:function(){return this.div.style[this.support.transform]="",this.div.style[this.support.transform]="rotateY(90deg)",""!==this.div.style[this.support.transform]},doDoubleTap:function(t,e,i){var a=this;e.hasAttribute(i.doubleTapIndicator)&&e.hasAttribute(i.doubleTapStart)&&(e.removeAttribute(i.doubleTapStart),clearTimeout(e.getAttribute(i.doubleTapStart)),a.doubleTapCallback(t)),e.hasAttribute(i.doubleTapIndicator)&&!e.hasAttribute(i.doubleTapStart)&&e.setAttribute(i.doubleTapStart,setTimeout(function(){e.removeAttribute(i.doubleTapStart),clearTimeout(e.getAttribute(i.doubleTapStart))},i.doubleTapThreshold))},setupSwipe:function(t,e,i){var a=this;e.hasAttribute(i.swipeRight)&&(e.removeAttribute(i.swipeRightEnd),e.hasAttribute(i.swipeRightInit)||e.setAttribute(i.swipeRightInit,JSON.stringify(a.getTouchPoints(t)))),e.hasAttribute(i.swipeLeft)&&(e.removeAttribute(i.swipeLeftEnd),e.hasAttribute(i.swipeLeftInit)||e.setAttribute(i.swipeLeftInit,JSON.stringify(a.getTouchPoints(t)))),e.hasAttribute(i.swipeUp)&&(e.removeAttribute(i.swipeUpEnd),e.hasAttribute(i.swipeUpInit)||e.setAttribute(i.swipeUpInit,JSON.stringify(a.getTouchPoints(t)))),e.hasAttribute(i.swipeDown)&&(e.removeAttribute(i.swipeDownEnd),e.hasAttribute(i.swipeDownInit)||e.setAttribute(i.swipeDownInit,JSON.stringify(a.getTouchPoints(t))))},setupTouch:function(){var t=this,e=this.settings;[].forEach.call(this.node,function(i){var a=function(a){a.preventDefault(),t.touchMoveHandler.call(t,a,i,e)},n=function(a){a.preventDefault(),t.endTouchHandler.call(t,a,i,e)},o=function(a){a.preventDefault(),t.startTouchHandler.call(t,a,i,e)};i.addEventListener(t.touchStart,o),i.addEventListener(t.touchMove,a),i.addEventListener(t.touchEnd,n),t.hasMouse&&(i.addEventListener("mousedown",o),i.addEventListener("mousemove",a),i.addEventListener("mouseup",n))})},startTouchHandler:function(t,e,i){var a=this;i=this.settings,t.preventDefault(),console.log("touch start"),e.hasAttribute(i.moveIndicator)&&(e.removeAttribute(i.moveTouchEnded),e.hasAttribute(i.moveTouchInitial)||e.setAttribute(i.moveTouchInitial,JSON.stringify(a.getTouchPoints(t)))),e.hasAttribute(i.horizontalIndicator)&&(e.removeAttribute(i.horizontalTouchEnd),e.hasAttribute(i.horizontalTouchInit)||e.setAttribute(i.horizontalTouchInit,JSON.stringify(a.getTouchPoints(t)))),e.hasAttribute(i.verticalIndicator)&&(e.removeAttribute(i.verticalTouchEnd),e.hasAttribute(i.verticalTouchInit)||e.setAttribute(i.verticalTouchInit,JSON.stringify(a.getTouchPoints(t)))),a.setupSwipe(t,e,i),e.hasAttribute(i.tapIndicator)&&!e.hasAttribute(i.tapStart)&&e.setAttribute(i.tapStart,setTimeout(function(){clearTimeout(e.getAttribute(i.tapStart)),e.removeAttribute(i.doubleTapStart)},700)),a.doDoubleTap(t,e,i)},endTouchHandler:function(t,e,i){var a=this;i=this.settings,t.preventDefault(),e.hasAttribute(i.moveTouchInitial)&&e.setAttribute(i.moveTouchEnded,"true"),e.hasAttribute(i.horizontalIndicator)&&e.setAttribute(i.horizontalTouchEnd,"true"),e.hasAttribute(i.verticalIndicator)&&e.setAttribute(i.verticalTouchEnd,"true"),e.hasAttribute(i.swipeRight)&&e.setAttribute(i.swipeRightEnd,"true"),e.hasAttribute(i.swipeLeft)&&e.setAttribute(i.swipeLeftEnd,"true"),e.hasAttribute(i.swipeUp)&&e.setAttribute(i.swipeUpEnd,"true"),e.hasAttribute(i.swipeDown)&&e.setAttribute(i.swipeDownEnd,"true"),e.hasAttribute(i.tapIndicator)&&e.hasAttribute(i.tapStart)&&(a.tapCallback(t),clearTimeout(e.getAttribute(i.tapStart)),e.removeAttribute(i.tapStart))},touchMoveHandler:function(t,e,i){var a=this;if(i=this.settings,t.preventDefault(),e.hasAttribute(i.moveIndicator)&&!e.hasAttribute(i.moveTouchEnded)&&e.hasAttribute(i.moveTouchInitial)&&(n=JSON.parse(e.getAttribute(i.moveTouchInitial)),o=a.getTouchPoints(t),s=a.calculateTranslation(n,o),e.style[a.support.transform]="translate3D("+s.translationX+"px, "+s.translationY+"px, 0)"),e.hasAttribute(i.horizontalIndicator)&&!e.hasAttribute(i.horizontalTouchEnd)&&e.hasAttribute(i.horizontalTouchInit)){console.log("should -horizontal move");var n=JSON.parse(e.getAttribute(i.horizontalTouchInit)),o=a.getTouchPoints(t),s=a.calculateTranslation(n,o);Math.abs(s.translationX)>a.settings.moveThreshold&&(e.style[a.support.transform]="translate3D("+s.translationX+"px, 0, 0)")}if(e.hasAttribute(i.verticalIndicator)&&!e.hasAttribute(i.verticalTouchEnd)&&e.hasAttribute(i.verticalTouchInit)){var n=JSON.parse(e.getAttribute(i.verticalTouchInit)),o=a.getTouchPoints(t),s=a.calculateTranslation(n,o);Math.abs(s.translationY)>a.settings.moveThreshold&&(e.style[a.support.transform]="translate3D(0, "+s.translationY+"px, 0)")}if(e.hasAttribute(i.swipeRight)&&!e.hasAttribute(i.swipeRightEnd)&&e.hasAttribute(i.swipeRightInit)){console.log("should swipe right");var n=JSON.parse(e.getAttribute(i.swipeRightInit)),o=a.getTouchPoints(t),s=a.calculateTranslation(n,o);s.translationX>0&&Math.abs(s.translationX)>i.swipeRightThreshold&&(a.swipeRightCallback(t,null,s),e.setAttribute(i.swipeLeftInit,JSON.stringify(a.getTouchPoints(t))),e.setAttribute(i.swipeRightInit,JSON.stringify(a.getTouchPoints(t))))}if(e.hasAttribute(i.swipeLeft)&&!e.hasAttribute(i.swipeLeftEnd)&&e.hasAttribute(i.swipeLeftInit)){console.log("should swipe left");var n=JSON.parse(e.getAttribute(i.swipeLeftInit)),o=a.getTouchPoints(t),s=a.calculateTranslation(n,o);0>s.translationX&&Math.abs(s.translationX)>i.swipeLeftThreshold&&(a.swipeLeftCallback(t,null,s),e.setAttribute(i.swipeLeftInit,JSON.stringify(a.getTouchPoints(t))),e.setAttribute(i.swipeRightInit,JSON.stringify(a.getTouchPoints(t))))}if(e.hasAttribute(i.swipeUp)&&!e.hasAttribute(i.swipeUpEnd)&&e.hasAttribute(i.swipeUpInit)){console.log("should swipe up");var n=JSON.parse(e.getAttribute(i.swipeUpInit)),o=a.getTouchPoints(t),s=a.calculateTranslation(n,o);0>s.translationY&&Math.abs(s.translationY)>i.swipeUpThreshold&&(a.swipeUpCallback(t,null,s),e.setAttribute(i.swipeUpInit,JSON.stringify(a.getTouchPoints(t))),e.setAttribute(i.swipeDownInit,JSON.stringify(a.getTouchPoints(t))))}if(e.hasAttribute(i.swipeDown)&&!e.hasAttribute(i.swipeDownEnd)&&e.hasAttribute(i.swipeDownInit)){console.log("should swipe down");var n=JSON.parse(e.getAttribute(i.swipeDownInit)),o=a.getTouchPoints(t),s=a.calculateTranslation(n,o);s.translationY>0&&s.translationY>i.swipeDownThreshold&&(a.swipeDownCallback(t,null,s),e.setAttribute(i.swipeUpInit,JSON.stringify(a.getTouchPoints(t))),e.setAttribute(i.swipeDownInit,JSON.stringify(a.getTouchPoints(t))))}},swipeRight:function(t,e){return this.setupIndicator(t,"swipeRightCallback",e,"swipeRightThreshold","swipeRight"),this},swipeLeft:function(t,e){return this.setupIndicator(t,"swipeLeftCallback",e,"swipeLeftThreshold","swipeLeft"),this},swipeUp:function(t,e){return this.setupIndicator(t,"swipeUpCallback",e,"swipeUpThreshold","swipeUp"),this},swipeDown:function(t,e){return this.setupIndicator(t,"swipeDownCallback",e,"swipeDownThreshold","swipeDown"),this},move:function(t){return this.setupIndicator(t,"moveCallback",0,"","moveIndicator"),this},horizontalMove:function(t){return this.setupIndicator(t,"moveHorizontalCallback",0,"","horizontalIndicator"),this},verticalMove:function(t){return this.setupIndicator(t,"moveVerticalCallback",0,"","verticalIndicator"),this},rotate:function(t){return this.setupIndicator(t,"rotateCallback",0,"","rotateIndicator"),this},scale:function(t){return this.setupIndicator(t,"scaleCallback",0,"","scaleIndicator"),this},settings:{allowPageScroll:!0,logging:!1,swipeRightThreshold:25,swipeLeftThreshold:-25,swipeUpThreshold:25,swipeDownThreshold:25,moveThreshold:0,rotateThreshold:0,scaleThreshold:0,doubleTapThreshold:700,tapIndicator:"data-tap",tapStart:"data-tap-start",tapEnded:"data-tap-end",doubleTapIndicator:"data-dbltap",doubleTapStart:"data-dbltap-start",doubleTapEnded:"data-dbltap-end",rotateIndicator:"data-rotate",rotateEnded:"data-rotate-ended",rotateInitial:"data-rotate-initial",scaleIndicator:"data-scale",scaleEnded:"data-scale-ended",scaleInitial:"data-scale-initial",moveIndicator:"data-move",moveTouchEnded:"data-move-touch-ended",moveTouchInitial:"data-move-touch-initial",swipeRight:"data-swiperight",swipeRightInit:"data-swiperight-init",swipeRightEnd:"data-swiperight-end",swipeLeft:"data-swipeleft",swipeLeftInit:"data-swipeLeft-init",swipeLeftEnd:"data-swipeleft-end",swipeUp:"data-swipeup",swipeUpInit:"data-swipeup-init",swipeUpEnd:"data-swipeup-end",swipeDown:"data-swipedown",swipeDownInit:"data-swipedown-init",swipeDownEnd:"data-swipedown-end",horizontalIndicator:"data-move-horizontal",horizontalTouchInit:"data-horizontal-touch-initial",horizontalTouchEnd:"data-horizontal-touch-ended",verticalIndicator:"data-move-vertical",verticalTouchInit:"data-vertical-touch-initial",verticalTouchEnd:"data-vertical-touch-ended"}},i.fn.init.prototype=i.fn,t.deeptissue=i})(window),function(t,e){"use strict";e.fn.move=function(t){return this.setupIndicator(t,"moveCallback",0,"","moveIndicator"),this},e.fn.horizontalMove=function(t){return this.setupIndicator(t,"moveHorizontalCallback",0,"","horizontalIndicator"),this},e.fn.verticalMove=function(t){return this.setupIndicator(t,"moveVerticalCallback",0,"","verticalIndicator"),this}}(window,deeptissue),function(t,e){"use strict";e.fn.tap=function(t){var e=this;return t||(t=function(){}),e.hasmsGesture?[].forEach.call(this.node,function(e){e.addEventListener("MSGestureTap",t,!1)}):this.setupIndicator(t,"tapCallback",0,"","tapIndicator"),this},e.fn.dblTap=function(t){var e=this.settings;return document.querySelector(".touch-log"),t&&(e.doubleTapCallback=t),this.setupIndicator(t,"doubleTapCallback",0,"","doubleTapIndicator"),this},e.fn.tapHold=function(t){var e=this;return t&&(e.tapHoldBeginCallback=t),this.hasmsGesture?[].forEach.call(this.node,function(t){t.addEventListener("MSGestureHold",function(t){e.tapHoldCallback.call(e,t)},!1)}):[].forEach.call(this.node,function(t){t.addEventListener(e.touchStart,function(i){e.setupTapHold(t,i)}),e.hasMouse&&t.addEventListener("mousedown",function(i){e.setupTapHold(t,i)})},!1),this},e.fn.setupTapHold=function(t,e){var i,a=this;i=setTimeout(function(){a.tapHoldBeginCallback.call(a,e),clearTimeout(i)},500),t.addEventListener(a.touchEnd,function(){clearTimeout(i)},!1),t.addEventListener(a.touchCancel,function(){clearTimeout(i)},!1)},e.fn.tapHoldBeginCallback=function(){},e.fn.tapHoldEndCallback=function(){},e.fn.tapHoldCancelCallback=function(){},e.fn.tapHoldCallback=function(t){console.info("evt.detail - "+t.detail),t.detail&t.MSGESTURE_FLAG_BEGIN&&this.tapHoldBeginCallback.call(this,t),t.detail&t.MSGESTURE_FLAG_END&&this.tapHoldEndCallback.call(this,t),t.detail&t.MSGESTURE_FLAG_CANCEL&&this.tapHoldCancelCallback.call(this,t)}}(window,deeptissue),function(t,e){"use strict";e.fn.rotate=function(t){return this.setupIndicator(t,"rotateCallback",0,"","rotateIndicator"),this}}(window,deeptissue),function(t,e){"use strict";e.fn.scale=function(t){return this.setupIndicator(t,"scaleCallback",0,"","scaleIndicator"),this}}(window,deeptissue);